{
  "kind": "build_request",
  "title": "Responsive tab navigation, weekend inclusion controls, and filtered PDF/Excel report export",
  "priority": "normal",
  "requirements": [
    {
      "id": "REQ-1",
      "text": "Update the Ledger page so all main sections (Travellers, Daily, Summary, Car, Overall) are always available as separate, clearly clickable tabs on every screen size (including desktop), rather than switching to a non-tabbed multi-column layout on large screens.",
      "target": "frontend",
      "source": {
        "messageIds": [
          "msg-2"
        ],
        "quotes": [
          "if possible saprate clickable tab for all the tabs irespective of screen size"
        ]
      },
      "acceptanceCriteria": [
        "On small and large screens, the UI shows the same set of tabs: Travellers, Daily, Summary, Car, Overall.",
        "Each tab is independently clickable/tappable regardless of viewport size.",
        "The previous desktop 3-column layout is replaced (or made optional) so tab navigation is still the primary navigation on desktop.",
        "Unsaved-changes protection when navigating away from the Daily tab still works (the existing confirmation dialog still appears when draft changes exist)."
      ]
    },
    {
      "id": "REQ-2",
      "text": "Add user controls (checkboxes) to enable/disable tracking for Saturdays and Sundays separately, and use these controls to determine whether weekend dates are editable in the Daily Participation grid.",
      "target": "frontend",
      "source": {
        "messageIds": [
          "msg-2"
        ],
        "quotes": [
          "Also allow to add check box for Saturday-Sunday"
        ]
      },
      "acceptanceCriteria": [
        "The UI includes two independent toggles/checkboxes labeled in English: \"Include Saturday\" and \"Include Sunday\" (or equivalent).",
        "When a weekend day is excluded, its Daily grid checkboxes are disabled (read-only) similar to current behavior.",
        "When a weekend day is included, its Daily grid checkboxes are enabled and can be checked/unchecked.",
        "The bulk \"Mark all travellers for today\" control respects these weekend toggles (disabled only if today is an excluded weekend day).",
        "The include/exclude weekend selection persists for the user (e.g., via the existing local state persistence pattern)."
      ]
    },
    {
      "id": "REQ-3",
      "text": "Include weekend data in summaries by calculating and displaying weekday vs weekend trip counts (and associated charges) based on the Saturday/Sunday inclusion toggles, and ensure totals reflect included weekend days.",
      "target": "frontend",
      "source": {
        "messageIds": [
          "msg-2"
        ],
        "quotes": [
          "also calculate data of weekend in the summary also"
        ]
      },
      "acceptanceCriteria": [
        "Summary calculations (per traveller) include trips from included weekend days in totals.",
        "Summary UI shows a clear breakdown of trip counts for weekdays vs weekend (at minimum: weekday trips and weekend trips).",
        "Overall Summary calculations (income/profit) include included weekend trips in the income computation.",
        "If both Saturday and Sunday are excluded, weekend trip counts display as 0 and do not affect totals."
      ]
    },
    {
      "id": "REQ-4",
      "text": "Add report generation that supports exporting filtered reports to PDF and an Excel-compatible format (preferably .xlsx), with multiple user-selectable filters for what data to include in the report.",
      "target": "frontend",
      "source": {
        "messageIds": [
          "msg-2"
        ],
        "quotes": [
          "also a pdf report or .xlms report genration with multiple filters"
        ]
      },
      "acceptanceCriteria": [
        "The existing \"Export CSV\" action is replaced or expanded into an export UI that lets the user choose an output format: PDF and Excel-compatible (e.g., XLSX) in addition to the existing CSV if kept.",
        "The export UI provides multiple filters (at minimum): date range (uses current selected date range), selected travellers (all vs subset), and include/exclude sections (Daily Grid, Per-traveller Summary, Payments, Car Expenses, Overall Summary).",
        "Exported files reflect the chosen filters (excluded sections/travellers are not present; included sections are present).",
        "Weekend inclusion (Saturday/Sunday toggles) is respected by calculations shown in the exported summary sections.",
        "User-facing text for export actions and errors remains in English (e.g., success and failure toasts)."
      ]
    },
    {
      "id": "REQ-5",
      "text": "Apply a cohesive visual theme across the updated tabs and new controls (consistent spacing, typography, and component styling) without changing app functionality; choose a distinct palette that is not blue/purple and use it consistently.",
      "target": "frontend",
      "source": {
        "messageIds": [
          "msg-2"
        ],
        "quotes": [
          "Yes apply this UI"
        ]
      },
      "acceptanceCriteria": [
        "Tabs, weekend toggles, and the export/filter UI share a consistent visual style (spacing, sizing, typography).",
        "The theme uses a distinct, coherent color direction that is not primarily blue/purple.",
        "No user-facing text is introduced in a non-English language."
      ]
    }
  ],
  "constraints": [
    "Do not modify files under frontend/src/components/ui (Shadcn components must be composed, not edited).",
    "Do not edit frontend/src/hooks/useInternetIdentity.ts, frontend/src/hooks/useInternetIdentity.tsx, frontend/src/hooks/useActor.ts, or frontend/src/main.tsx (immutable paths).",
    "Keep backend as a single Motoko actor (no multi-canister architecture)."
  ],
  "nonGoals": [
    "Adding third-party authentication providers (only Internet Identity is supported).",
    "Real-time sync or multi-user collaboration for the ledger.",
    "Generating true macro-enabled Excel (.xlsm) with embedded VBA macros (focus on Excel-compatible export)."
  ],
  "imageRequirements": {
    "required": [],
    "edits": []
  }
}
{
  "kind": "spec_vs_diff_report",
  "version": "1.0",
  "generatedAt": "2026-02-13T12:17:19.941Z",
  "summary": "Diff adds a new \"Backup & Restore\" ledger tab/panel, JSON export/import utilities with merge logic, React Query hooks for backend backup endpoints, and backend Motoko exportBackup/importBackup with non-destructive profile restore. Most requested functionality appears implemented, but some REQ-4 UI/documentation and draft-vs-saved consistency aspects canâ€™t be fully verified from the truncated diff.",
  "missing_requirements": [
    {
      "id": "REQ-4",
      "requirement": "Settings fields (dateRange, ratePerTrip, includeSaturday, includeSunday): if restore applies these fields, their behavior must be documented in the UI (note describing whether settings are taken from backup or kept local).",
      "reason": "BackupRestorePanel.tsx is truncated before the explanatory UI content; no visible evidence that settings-restore behavior is documented.",
      "evidence": [
        "frontend/src/features/ledger/BackupRestorePanel.tsx (truncated)"
      ]
    },
    {
      "id": "REQ-4",
      "requirement": "After merge, both saved dailyData and draftDailyData remain consistent (draft reflects merged saved data unless the user currently has unsaved draft changes, in which case restore must require confirmation before applying).",
      "reason": "Confirmation-before-restore is evidenced in the panel, but the state-layer behavior ensuring draftDailyData is updated to reflect merged saved data after restore (when no unsaved draft changes) is not visible in the truncated useLedgerLocalState.ts / mergeRestoreFromBackup implementation.",
      "evidence": [
        "frontend/src/features/ledger/BackupRestorePanel.tsx",
        "frontend/src/hooks/useLedgerLocalState.ts (truncated)"
      ]
    }
  ],
  "hallucinated_features": [],
  "confidence": 0.64,
  "changed_files": [
    "backend/main.mo",
    "frontend-file-summaries.txt",
    "frontend/src/features/ledger/BackupRestorePanel.tsx",
    "frontend/src/features/ledger/LedgerPage.tsx",
    "frontend/src/features/ledger/LedgerStateContext.tsx",
    "frontend/src/hooks/useLedgerLocalState.ts",
    "frontend/src/hooks/useQueries.ts",
    "frontend/src/utils/backupRestore.ts",
    "project_state.json"
  ]
}